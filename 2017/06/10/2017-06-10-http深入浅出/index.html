<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="前端,http,浏览器,Web,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="1. 简介 HTTP 协议是互联网的基础协议，也是网页开发(无论前后端)的必备知识。若想在专业技术道路上走得更坚实，绝对不可能绕开学习 HTTP 协议这一环节。对基础及核心部分的深入学习是成为一名优秀技术人员的前提。  2. http/https 背景及发展简介，基本概念简介 HTTP 是基于 TCP/IP 协议的应用层协议。它不涉及数据包（packet）传输，主要规定了客户端和服务器之间的通信格">
<meta name="keywords" content="前端,http,浏览器,Web">
<meta property="og:type" content="article">
<meta property="og:title" content="http深入浅出">
<meta property="og:url" content="https://sunny-xl.github.io/2017/06/10/2017-06-10-http深入浅出/index.html">
<meta property="og:site_name" content="sunny-xl`s blog">
<meta property="og:description" content="1. 简介 HTTP 协议是互联网的基础协议，也是网页开发(无论前后端)的必备知识。若想在专业技术道路上走得更坚实，绝对不可能绕开学习 HTTP 协议这一环节。对基础及核心部分的深入学习是成为一名优秀技术人员的前提。  2. http/https 背景及发展简介，基本概念简介 HTTP 是基于 TCP/IP 协议的应用层协议。它不涉及数据包（packet）传输，主要规定了客户端和服务器之间的通信格">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://sunny-xl.github.io/blogImages/http0.png">
<meta property="og:image" content="https://sunny-xl.github.io/blogImages/http1.png">
<meta property="og:image" content="https://sunny-xl.github.io/blogImages/http2.png">
<meta property="og:image" content="https://sunny-xl.github.io/blogImages/http3.png">
<meta property="og:image" content="https://sunny-xl.github.io/blogImages/http4.png">
<meta property="og:image" content="https://sunny-xl.github.io/blogImages/http5.png">
<meta property="og:image" content="https://sunny-xl.github.io/blogImages/http6.png">
<meta property="og:image" content="https://sunny-xl.github.io/blogImages/http7.png">
<meta property="og:updated_time" content="2021-05-14T14:18:53.978Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="http深入浅出">
<meta name="twitter:description" content="1. 简介 HTTP 协议是互联网的基础协议，也是网页开发(无论前后端)的必备知识。若想在专业技术道路上走得更坚实，绝对不可能绕开学习 HTTP 协议这一环节。对基础及核心部分的深入学习是成为一名优秀技术人员的前提。  2. http/https 背景及发展简介，基本概念简介 HTTP 是基于 TCP/IP 协议的应用层协议。它不涉及数据包（packet）传输，主要规定了客户端和服务器之间的通信格">
<meta name="twitter:image" content="https://sunny-xl.github.io/blogImages/http0.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://sunny-xl.github.io/2017/06/10/2017-06-10-http深入浅出/">





  <title> http深入浅出 | sunny-xl`s blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">sunny-xl`s blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description"></h1>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://sunny-xl.github.io/2017/06/10/2017-06-10-http深入浅出/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="sunny-xl">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/avatar/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="sunny-xl`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="sunny-xl`s blog" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                http深入浅出
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-10T21:28:24+08:00">
                2017-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><blockquote>
<p>HTTP 协议是互联网的基础协议，也是网页开发(无论前后端)的必备知识。若想在专业技术道路上走得更坚实，绝对不可能绕开学习 HTTP 协议这一环节。对基础及核心部分的深入学习是成为一名优秀技术人员的前提。</p>
</blockquote>
<h2 id="2-http-https-背景及发展简介，基本概念简介"><a href="#2-http-https-背景及发展简介，基本概念简介" class="headerlink" title="2. http/https 背景及发展简介，基本概念简介"></a>2. http/https 背景及发展简介，基本概念简介</h2><blockquote>
<p>HTTP 是基于 TCP/IP 协议的应用层协议。它不涉及数据包（packet）传输，主要规定了客户端和服务器之间的通信格式，默认使用 80 端口。</p>
</blockquote>
<ul>
<li>网络基础 TCP/IP:<ul>
<li><a href="https://user-gold-cdn.xitu.io/2018/7/5/16467f6993c6bad9" target="_blank" rel="noopener">网络分层</a></li>
</ul>
</li>
<li>HTTP 超文本传输协议(Hypertext Transfer Protocol)：</li>
</ul>
<blockquote>
<p>用于传输超媒体文档（如 HTML）的应用层协议。 它专为 Web 浏览器和 Web 服务器之间的通信而设计，但也可用于其他目的。 HTTP 遵循传统的客户端-服务器模型，客户端打开连接以发出请求，然后等待它收到响应。 HTTP 是无状态协议，这意味着服务器不会在两个请求之间保留任何数据（状态）。 虽然通常基于 TCP / IP 层，但它可以在任何可靠的传输层上使用; 也就是说，一种不会无声地丢失消息的协议，例如 UDP。</p>
</blockquote>
<ul>
<li>HTTP 是一种允许获取资源的协议，例如 HTML 文档。 它是 Web 上任何数据交换和客户端- 服务器协议的基础，这意味着请求由接收者（通常是 Web 浏览器）发起。 从所获取的不同子文档重建完整文档，例如文本，布局描述，图像，视频，脚本等。</li>
</ul>
<p><img src="/blogImages/http0.png" alt></p>
<ul>
<li>URI/URL/URN:<ul>
<li>URI(Uniform Resource Indentifier):由某个协议方案表示等资源定位标识符。包含 UIL（Location）和 URN（永久资源定位符）</li>
</ul>
</li>
<li>报文格式：<br><img src="/blogImages/http1.png" alt></li>
</ul>
<a id="more"></a>
<h3 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h3><p>确保数据到达目标：三次 🤝（three-way handshaking）<br>TCP 的 flag：SYN（synchronize）和 ACK（acknowledgement）</p>
<ul>
<li>syn</li>
<li>syn + ack</li>
<li>ack<br><img src="/blogImages/http2.png" alt></li>
</ul>
<h3 id="http-发展"><a href="#http-发展" class="headerlink" title="http 发展"></a>http 发展</h3><ul>
<li>http/0.9<ul>
<li>只有一个命令 get</li>
<li>协议规定，服务器只能回应 HTML 格式的字符串，不能回应别的格式。</li>
<li>没有 header 等描述数据的信息</li>
<li>服务器发送完毕，tcp 连接就关闭</li>
</ul>
</li>
<li><p>http/1.0</p>
<ul>
<li>任何格式的内容都可以发送。这使得互联网不仅可以传输文字，还能传输图像、视频、二进制文件</li>
<li>更多命令(GET 命令，还引入了 POST 命令和 HEAD)</li>
<li>HTTP 请求和回应的格式也变了。除了数据部分，每次通信都必须包括头信息（HTTP header），用来描述一些元数据。</li>
<li>其他的新增功能还包括状态码（status code）、多字符集支持、多部分发送（multi-part type）、权限（authorization）、缓存（cache）、内容编码（content encoding）等。</li>
<li>HTTP/1.0 版的主要缺点是，每个 TCP 连接只能发送一个请求。</li>
<li>Content-Type 字段:关于字符的编码，1.0 版规定，头信息必须是 ASCII 码，后面的数据可以是任何格式。因此，服务器回应的时候，必须告诉客户端，数据是什么格式</li>
</ul>
</li>
<li><p>http/1.1</p>
<ul>
<li>持久连接（persistent connection）:TCP 连接默认不关闭，可以被多个请求复用，不用声明<code>Connection: keep-alive</code>。</li>
<li>pipeline:在同一个 TCP 连接里面，客户端可以同时发送多个请</li>
<li>Content-Length 字段:一个 TCP 连接现在可以传送多个回应，势必就要有一种机制，区分数据包是属于哪一个回应,声明本次回应的数据长度.</li>
<li>分块传输编码:产生一块数据，就发送一块，采用”流模式”（stream）取代”缓存模式”（buffer)</li>
<li>增加 host 和其它命令(PUT、PATCH、HEAD、 OPTIONS、DELETE),客户端请求的头信息新增了 Host 字段，用来指定服务器的域名.<code>Host: mp.weixin.qq.com</code></li>
<li>缺点：<a href="https://zh.wikipedia.org/wiki/%E9%98%9F%E5%A4%B4%E9%98%BB%E5%A1%9E" target="_blank" rel="noopener">队头堵塞</a>，为了避免这个问题，只有两种方法：一是减少请求数，二是同时多开持久连接。这导致了很多的网页优化技巧，比如合并脚本和样式表、将图片嵌入 CSS 代码、域名分片（domain sharding）等等。</li>
</ul>
</li>
<li><p>SPDY 协议：2009 年，谷歌公开了自行研发的 SPDY 协议，主要解决 HTTP/1.1 效率不高的问题。这个协议在 Chrome 浏览器上证明可行以后，就被当作 HTTP/2 的基础</p>
</li>
<li><p>http2（2015 年，HTTP/2 发布。它不叫 HTTP/2.0，是因为标准委员会不打算再发布子版本了，下一个新版本将是 HTTP/3。）</p>
<ul>
<li>只有在 HTTPS 环境才会生效</li>
<li>二进制协议：头信息和数据体都是二进制，并且统称为”帧”（frame）：头信息帧和数据帧。可以定义额外的帧</li>
<li>多工（Multiplexing）：同一个连接里发送多个请求无需按顺序</li>
<li>数据流：每个请求或回应的所有数据包，称为一个数据流（stream）。每个数据流都有一个独一无二的编号。数据包发送的时候，都必须标记数据流 ID，用来区分它属于哪个数据流。另外还规定，客户端发出的数据流，ID 一律为奇数，服务器发出的，ID 为偶数。HTTP/2 可以取消某一次请求，同时保证 TCP 连接还打开着，可以被其他请求使用。客户端还可以指定数据流的优先级。优先级越高，服务器就会越早回应。</li>
<li>头信息压缩（header compression）：<br>推送更高效，一方面，头信息使用 gzip 或 compress 压缩后再发送；另一方面，客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了。</li>
<li>服务器推送（server push）：HTTP/2 允许服务器未经请求，主动向客户端发送资源。服务器可以预期到客户端请求网页后，很可能会再请求静态资源，所以就主动把这些静态资源随着网页一起发给客户端了。</li>
</ul>
</li>
</ul>
<h2 id="3-http-常见特性总结及梳理"><a href="#3-http-常见特性总结及梳理" class="headerlink" title="3. http 常见特性总结及梳理"></a>3. http 常见特性总结及梳理</h2><h2 id="4-常见跨域情形，几种常见跨域解决方案及原理"><a href="#4-常见跨域情形，几种常见跨域解决方案及原理" class="headerlink" title="4. 常见跨域情形，几种常见跨域解决方案及原理"></a>4. 常见跨域情形，几种常见跨域解决方案及原理</h2><ul>
<li>系统讲解：<a href="https://www.imooc.com/learn/947" target="_blank" rel="noopener">https://www.imooc.com/learn/947</a></li>
</ul>
<h3 id="浏览器同源政策及其规避方法"><a href="#浏览器同源政策及其规避方法" class="headerlink" title="浏览器同源政策及其规避方法"></a>浏览器同源政策及其规避方法</h3><ul>
<li><a href="https://en.wikipedia.org/wiki/Same-origin_policy" target="_blank" rel="noopener">同源策略（Same-origin_policy）</a></li>
<li>同源：协议&amp;&amp;域名&amp;&amp;端口三者均相同；</li>
<li>同源目的：保证用户信息的安全，防止恶意的网站窃取数据；</li>
<li>同源限制：<ul>
<li>Cookie、LocalStorage 和 IndexDB 无法读取；</li>
<li>DOM 无法获得；</li>
<li>AJAX 请求不能发送</li>
</ul>
</li>
<li><p><a href="https://zh.wikipedia.org/wiki/AJAX" target="_blank" rel="noopener">Ajax</a>：同源政策规定，AJAX 请求只能发给同源的网址.除了架设服务器代理（浏览器请求同源服务器，再由后者请求外部服务），有三种方法规避这个限制:</p>
<ul>
<li>jsonp:简单，老式浏览器全部支持，服务器改造非常小.不受同源政策限制；服务器收到请求后，将数据放在一个指定名字的回调函数里传回来。但只支持 GET 请求。</li>
<li>websocket:WebSocket 是一种通信协议，使用 ws://（非加密）和 wss://（加密）作为协议前缀。该协议不实行同源政策，只要服务器支持，就可以通过它进行跨源通信。有一个字段是 Origin，表示该请求的请求源（origin），即发自哪个域名.</li>
<li><p><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">CORS:</a></p>
<ul>
<li>CORS 需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE 浏览器不能低于 IE10。</li>
<li>请求分类：<ul>
<li>简单请求（simple request）：<ol>
<li>请求方法是以下三种方法之一：HEAD/GET/POST</li>
<li>HTTP 的头信息不超出以下几种字段：<br>Accept/Accept-Language/Content-Language/Last-Event-ID/Content-Type：只限于三个值 application/x-www-form-urlencoded、multipart/form-data、text/plain</li>
</ol>
</li>
<li>非简单请求（not-so-simple request）：非上</li>
</ul>
</li>
<li><p>请求分类处理：</p>
<ul>
<li><p>简单请求：</p>
<ul>
<li>头信息之中，增加一个 Origin 字段：说明，本次请求来自哪个源（协议 + 域名 +端口）。服务器根据这个值，决定是否同意这次请求。</li>
<li><p>如果 Origin 指定的域名在许可范围内，服务器返回的响应，会多出几个头信息字段。</p>
<ul>
<li>Access-Control-Allow-Origin：必须，接受请求的域名</li>
<li><p>Access-Control-Allow-Credentials：可选，是否允许发送 Cookie。如果要把 Cookie 发到服务器，一方面要服务器同意，指定 Access-Control-Allow-Credentials 字段。<code>Access-Control-Allow-Credentials: true</code>;另一方面，开发者必须在 AJAX 请求中打开 withCredentials 属性。<code>var xhr = new XMLHttpRequest();xhr.withCredentials = true;</code> <strong>⚠️：如果要发送 Cookie，Access-Control-Allow-Origin 就不能设为星号，必须指定明确的、与请求网页一致的域名。同时，Cookie 依然遵循同源政策，只有用服务器域名设置的 Cookie 才会上传，其他域名的 Cookie 并不会上传，且（跨源）原网页代码中的 document.cookie 也无法读取服务器域名下的 Cookie</strong></p>
</li>
<li><p>Access-Control-Expose-Headers：可选。CORS 请求时，XMLHttpRequest 对象的 getResponseHeader()方法只能拿到 6 个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在 Access-Control-Expose-Headers 里面指定</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>非简单请求：对服务器有特殊要求的请求，比如请求方法是 PUT 或 DELETE，或者 Content-Type 字段的类型是 application/json。非简单请求的 CORS 请求，会在正式通信之前，增加一次 HTTP 查询请求，称为”预检”请求（preflight）。</p>
<ul>
<li><p>预检请求：非简单请求的 CORS 请求，会在正式通信之前，增加一次 HTTP 查询请求，称为”预检”请求（preflight）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS /cors HTTP/1.1</span><br><span class="line">Origin: http://api.bob.com</span><br><span class="line">Access-Control-Request-Method: PUT //CORS请求会用到哪些HTTP方法</span><br><span class="line">Access-Control-Request-Headers: X-Custom-Header</span><br><span class="line">Host: api.alice.com // 浏览器CORS请求会额外发送的头信息字段</span><br><span class="line">Accept-Language: en-US</span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: Mozilla/5.0...</span><br></pre></td></tr></table></figure>
</li>
<li><p>预检响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Mon, 01 Dec 2008 01:15:39 GMT</span><br><span class="line">Server: Apache/2.0.61 (Unix)</span><br><span class="line">Access-Control-Allow-Origin: http://api.bob.com  //同意跨源的url</span><br><span class="line">Access-Control-Allow-Methods: GET, POST, PUT //服务器支持的所有跨域请求的方法</span><br><span class="line">Access-Control-Allow-Headers: X-Custom-Header //服务器支持的所有头信息字段，不限于浏览器在&quot;预检&quot;中请求的字段</span><br><span class="line">Access-Control-Max-Age ：3600 //本次预检请求的有效期，单位为秒。</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Content-Encoding: gzip</span><br><span class="line">Content-Length: 0</span><br><span class="line">Keep-Alive: timeout=2, max=100</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Content-Type: text/plain</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="跨域通用解决方案"><a href="#跨域通用解决方案" class="headerlink" title="跨域通用解决方案"></a>跨域通用解决方案</h3><ul>
<li><p><a href="https://segmentfault.com/a/1190000011145364" target="_blank" rel="noopener">总结最全面具体的一篇博文</a></p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" target="_blank" rel="noopener">内容安全策略 CSP</a></p>
</li>
</ul>
<h2 id="5-RESTful-简介"><a href="#5-RESTful-简介" class="headerlink" title="5. RESTful 简介"></a>5. RESTful 简介</h2><p>REST(REpresentational State Transfer)这个概念，首次出现是在 2000 年 Roy Thomas Fielding（他是 HTTP 规范的主要编写者之一）的博士论文中，它指的是一组架构约束条件和原则。满足这些约束条件和原则的应用程序或设计就是 RESTful 的。</p>
<p>简单地理解就是<a href="https://www.zhihu.com/people/6ef2e77274cb0719253a577665cf690e" target="_blank" rel="noopener">@Ivony<br>老师</a>：<strong>URL 定位资源，用 HTTP 动词（GET,POST,DELETE,DETC）描述操作。</strong></p>
<p>要理解什么是 REST，我们需要理解下面几个概念:</p>
<ul>
<li><p>资源（Resources）<br>REST 是”表现层状态转化”，其实它省略了主语。”表现层”其实指的是”资源”的”表现层”。</p>
<p>那么什么是资源呢？就是我们平常上网访问的一张图片、一个文档、一个视频等。这些资源我们通过 URI 来定位，也就是一个 URI 表示一个资源。</p>
</li>
<li><p>表现层（Representation）</p>
<p>资源是做一个具体的实体信息，他可以有多种的展现方式。而把实体展现出来就是表现层，例如一个 txt 文本信息，他可以输出成 html、json、xml 等格式，一个图片他可以 jpg、png 等方式展现，这个就是表现层的意思。</p>
<p>URI 确定一个资源，但是如何确定它的具体表现形式呢？应该在 HTTP 请求的头信息中用 Accept 和 Content-Type 字段指定，这两个字段才是对”表现层”的描述。</p>
</li>
<li><p>状态转化（State Transfer）</p>
<p>访问一个网站，就代表了客户端和服务器的一个互动过程。在这个过程中，肯定涉及到数据和状态的变化。而 HTTP 协议是无状态的，那么这些状态肯定保存在服务器端，所以如果客户端想要通知服务器端改变数据和状态的变化，肯定要通过某种方式来通知它。</p>
<p>客户端能通知服务器端的手段，只能是 HTTP 协议。具体来说，就是 HTTP 协议里面，四个表示操作方式的动词：GET、POST、PUT、DELETE。它们分别对应四种基本操作：GET 用来获取资源，POST 用来新建资源（也可以用于更新资源），PUT 用来更新资源，DELETE 用来删除资源。</p>
</li>
</ul>
<p>综合上面的解释，我们总结一下什么是 RESTful 架构：</p>
<ul>
<li>（1）每一个 URI 代表一种资源；</li>
<li>（2）客户端和服务器之间，传递这种资源的某种表现层；</li>
<li>（3）客户端通过四个 HTTP 动词，对服务器端资源进行操作，实现”表现层状态转化”。</li>
</ul>
<p>Web 应用要满足 REST 最重要的原则是:客户端和服务器之间的交互在请求之间是无状态的,即从客户端到服务器的每个请求都必须包含理解请求所必需的信息。如果服务器在请求之间的任何时间点重启，客户端不会得到通知。此外此请求可以由任何可用服务器回答，这十分适合云计算之类的环境。因为是无状态的，所以客户端可以缓存数据以改进性能。</p>
<p>另一个重要的 REST 原则是系统分层，这表示组件无法了解除了与它直接交互的层次以外的组件。通过将系统知识限制在单个层，可以限制整个系统的复杂性，从而促进了底层的独立性。</p>
<p>下图即是 REST 的架构图：</p>
<p><img src="/blogImages/http3.png" alt></p>
<p>图 8.5 REST 架构图</p>
<p>当 REST 架构的约束条件作为一个整体应用时，将生成一个可以扩展到大量客户端的应用程序。它还降低了客户端和服务器之间的交互延迟。统一界面简化了整个系统架构，改进了子系统之间交互的可见性。REST 简化了客户端和服务器的实现，而且对于使用 REST 开发的应用程序更加容易扩展。</p>
<p>下图展示了 REST 的扩展性：</p>
<p><img src="/blogImages/http4.png" alt></p>
<p>图 8.6 REST 的扩展性</p>
<h2 id="RESTful-的实现"><a href="#RESTful-的实现" class="headerlink" title="RESTful 的实现"></a>RESTful 的实现</h2><p>Go 没有为 REST 提供直接支持，但是因为 RESTful 是基于 HTTP 协议实现的，所以我们可以利用<code>net/http</code>包来自己实现，当然需要针对 REST 做一些改造，REST 是根据不同的 method 来处理相应的资源，目前已经存在的很多自称是 REST 的应用，其实并没有真正的实现 REST，我暂且把这些应用根据实现的 method 分成几个级别，请看下图：</p>
<p><img src="/blogImages/http5.png" alt></p>
<p>图 8.7 REST 的 level 分级</p>
<p>上图展示了我们目前实现 REST 的三个 level，我们在应用开发的时候也不一定全部按照 RESTful 的规则全部实现他的方式，因为有些时候完全按照 RESTful 的方式未必是可行的，RESTful 服务充分利用每一个 HTTP 方法，包括<code>DELETE</code>和<code>PUT</code>。可有时，HTTP 客户端只能发出<code>GET</code>和<code>POST</code>请求：</p>
<ul>
<li><p>HTML 标准只能通过链接和表单支持<code>GET</code>和<code>POST</code>。在没有 Ajax 支持的网页浏览器中不能发出<code>PUT</code>或<code>DELETE</code>命令</p>
</li>
<li><p>有些防火墙会挡住 HTTP <code>PUT</code>和<code>DELETE</code>请求，要绕过这个限制，客户端需要把实际的<code>PUT</code>和<code>DELETE</code>请求通过 POST 请求穿透过来。RESTful 服务则要负责在收到的 POST 请求中找到原始的 HTTP 方法并还原。</p>
</li>
</ul>
<p>我们现在可以通过<code>POST</code>里面增加隐藏字段<code>_method</code>这种方式可以来模拟<code>PUT</code>、<code>DELETE</code>等方式，但是服务器端需要做转换。我现在的项目里面就按照这种方式来做的 REST 接口。当然 Go 语言里面完全按照 RESTful 来实现是很容易的，我们通过下面的例子来说明如何实现 RESTful 的应用设计。</p>
<h2 id="6-Nginx"><a href="#6-Nginx" class="headerlink" title="6. Nginx"></a>6. Nginx</h2><p>Nginx 是 lgor Sysoev 为俄罗斯访问量第二的 rambler.ru 站点设计开发的。从 2004 年发布至今，凭借开源的力量，已经接近成熟与完善。</p>
<p>Nginx 功能丰富，可作为 HTTP 服务器，也可作为反向代理服务器，邮件服务器。支持 FastCGI、SSL、Virtual Host、URL Rewrite、Gzip 等功能。并且支持很多第三方的模块扩展。</p>
<p>Nginx 的稳定性、功能集、示例配置文件和低系统资源的消耗让他后来居上，在全球活跃的网站中有 12.18%的使用比率，大约为 2220 万个网站。</p>
<p>Nginx 常见功能：</p>
<ul>
<li>1、Http 代理，反向代理：作为 web 服务器最常用的功能之一，尤其是反向代理。</li>
</ul>
<p>Nginx 在做反向代理时，提供性能稳定，并且能够提供配置灵活的转发功能。Nginx 可以根据不同的正则匹配，采取不同的转发策略，比如图片文件结尾的走文件服务器，动态页面走 web 服务器，只要你正则写的没问题，又有相对应的服务器解决方案，你就可以随心所欲的玩。并且 Nginx 对返回结果进行错误页跳转，异常判断等。如果被分发的服务器存在异常，他可以将请求重新转发给另外一台服务器，然后自动去除异常服务器。</p>
<ul>
<li>2、负载均衡</li>
</ul>
<p>Nginx 提供的负载均衡策略有 2 种：内置策略和扩展策略。内置策略为轮询，加权轮询，Ip hash。扩展策略，就天马行空，只有你想不到的没有他做不到的啦，你可以参照所有的负载均衡算法，给他一一找出来做下实现。</p>
<p>Ip hash 算法，对客户端请求的 ip 进行 hash 操作，然后根据 hash 结果将同一个客户端 ip 的请求分发给同一台服务器进行处理，可以解决 session 不共享的问题。</p>
<ul>
<li>3、web 缓存</li>
</ul>
<p>Nginx 可以对不同的文件做不同的缓存处理，配置灵活，并且支持 FastCGI_Cache，主要用于对 FastCGI 的动态程序进行缓存。配合着第三方的 ngx_cache_purge，对制定的 URL 缓存内容可以的进行增删管理。</p>
<h2 id="7-https-TLS-简介及升级"><a href="#7-https-TLS-简介及升级" class="headerlink" title="7. https(TLS)简介及升级"></a>7. https(TLS)简介及升级</h2><ul>
<li><a href="http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html" target="_blank" rel="noopener">图解 SSL/TLS 协议</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank" rel="noopener">SSL/TLS 协议运行机制的概述</a></li>
<li>TLS 协议：<a href="https://www.networkworld.com/article/2303073/lan-wan/lan-wan-what-is-transport-layer-security-protocol.html" target="_blank" rel="noopener">Transport Layer Security protocol </a></li>
<li>握手过程：开始加密通信之前，客户端和服务器首先必须建立连接和交换参数，这个过程叫做握手（handshake）。</li>
<li><p><img src="/blogImages/http6.png" alt></p>
<ul>
<li><p>第一步，爱丽丝给出协议版本号、一个客户端生成的随机数（Client random），以及客户端支持的加密方法。</p>
</li>
<li><p>第二步，鲍勃确认双方使用的加密方法，并给出数字证书、以及一个服务器生成的随机数（Server random）。</p>
</li>
<li><p>第三步，爱丽丝确认数字证书有效，然后生成一个新的随机数（Premaster secret），并使用数字证书中的公钥，加密这个随机数，发给鲍勃。</p>
</li>
<li><p>第四步，鲍勃使用自己的私钥，获取爱丽丝发来的随机数（即 Premaster secret）。</p>
</li>
<li><p>第五步，爱丽丝和鲍勃根据约定的加密方法，使用前面的三个随机数，生成”对话密钥”（session key），用来加密接下来的整个对话过程。</p>
</li>
</ul>
</li>
<li><p><img src="/blogImages/http7.png" alt></p>
</li>
</ul>
<h4 id="如何将一个-HTTP-网站升级到-HTTPS"><a href="#如何将一个-HTTP-网站升级到-HTTPS" class="headerlink" title="如何将一个 HTTP 网站升级到 HTTPS"></a>如何将一个 HTTP 网站升级到 HTTPS</h4><ul>
<li>一、获取证书:证书是一个二进制文件，里面包含经过认证的网站公钥和一些元数据，要从经销商购买。</li>
<li>二、安装证书</li>
<li>三、修改链接:网页加载的 HTTP 资源，要全部改成 HTTPS 链接</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 改法一 --&gt;</span><br><span class="line">&lt;script src=&quot;https://foo.com/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;!-- 改法二:根据当前网页的协议，加载相同协议的外部资源，更灵活一些 --&gt;</span><br><span class="line">&lt;script src=&quot;//foo.com/jquery.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>四、301 重定向:修改 Web 服务器的配置文件，使用 301 重定向，将 HTTP 协议的访问导向 HTTPS 协议</li>
<li>五、安全措施<ul>
<li>确保浏览器只在使用 HTTPS 时，才发送 Cookie。<br>网站响应头里面，Set-Cookie 字段加上 Secure 标志即可。</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: LSID=DQAAAK...Eaem_vYg; Secure</span><br></pre></td></tr></table></figure>
<h2 id="8-参考连接"><a href="#8-参考连接" class="headerlink" title="8. 参考连接"></a>8. 参考连接</h2><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP</a></li>
<li><a href="https://yanlee26.github.io/2018/03/05/HTTP/" target="_blank" rel="noopener">https://yanlee26.github.io/2018/03/05/HTTP/</a></li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>满分是100分的话，这篇文章你给几分</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/reward/reward_wechat.png" alt="sunny-xl WeChat Pay">
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/reward/reward_alipay.png" alt="sunny-xl Alipay">
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/前端/" rel="tag"># 前端</a>
          
            <a href="/tags/http/" rel="tag"># http</a>
          
            <a href="/tags/浏览器/" rel="tag"># 浏览器</a>
          
            <a href="/tags/Web/" rel="tag"># Web</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/02/22/2017-02-22runloop/" rel="next" title="RunLoop 简介">
                <i class="fa fa-chevron-left"></i> RunLoop 简介
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/23/2017-12-23-vue/" rel="prev" title="vue(2.0)全家桶 总结及源码分析">
                vue(2.0)全家桶 总结及源码分析 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2017/06/10/2017-06-10-http深入浅出/" data-title="http深入浅出" data-content data-url="https://sunny-xl.github.io/2017/06/10/2017-06-10-http深入浅出/">
  <div class="ds-share-inline">
    <ul class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>

          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/avatar/avatar.png" alt="sunny-xl">
          <p class="site-author-name" itemprop="name">sunny-xl</p>
          <p class="site-description motion-element" itemprop="description">Stay Hungry,Stay Foolish</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/sunny-xl" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons">
            </a>
          </div>
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-简介"><span class="nav-number">1.</span> <span class="nav-text">1. 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-http-https-背景及发展简介，基本概念简介"><span class="nav-number">2.</span> <span class="nav-text">2. http/https 背景及发展简介，基本概念简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#三次握手"><span class="nav-number">2.1.</span> <span class="nav-text">三次握手</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#http-发展"><span class="nav-number">2.2.</span> <span class="nav-text">http 发展</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-http-常见特性总结及梳理"><span class="nav-number">3.</span> <span class="nav-text">3. http 常见特性总结及梳理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-常见跨域情形，几种常见跨域解决方案及原理"><span class="nav-number">4.</span> <span class="nav-text">4. 常见跨域情形，几种常见跨域解决方案及原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#浏览器同源政策及其规避方法"><span class="nav-number">4.1.</span> <span class="nav-text">浏览器同源政策及其规避方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#跨域通用解决方案"><span class="nav-number">4.2.</span> <span class="nav-text">跨域通用解决方案</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-RESTful-简介"><span class="nav-number">5.</span> <span class="nav-text">5. RESTful 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RESTful-的实现"><span class="nav-number">6.</span> <span class="nav-text">RESTful 的实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Nginx"><span class="nav-number">7.</span> <span class="nav-text">6. Nginx</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-https-TLS-简介及升级"><span class="nav-number">8.</span> <span class="nav-text">7. https(TLS)简介及升级</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#如何将一个-HTTP-网站升级到-HTTPS"><span class="nav-number">8.0.1.</span> <span class="nav-text">如何将一个 HTTP 网站升级到 HTTPS</span></a></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#8-参考连接"><span class="nav-number">9.</span> <span class="nav-text">8. 参考连接</span></a></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">sunny-xl</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"sunny-xl"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  

  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>

</body>
</html>
